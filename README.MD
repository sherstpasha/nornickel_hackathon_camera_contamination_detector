# Генерация синтетических изображений для расширения датасета

В нашем репозитории доступен код для создания синтетических изображений, позволяющий генерировать данные с различными эффектами и аугментациями. Это удобно для задач обучения моделей, где требуется искусственно увеличить объём данных или добавить реалистичные визуальные искажения. 

Подробную информацию о процессе и инструкции по использованию вы можете найти в [raindrop_aug.md](raindrop/raindrop_aug.md).

# Шаги для использования `train.ipynb`

#### 1. **Структура ячеек в `train.ipynb`**
Ваш Jupyter Notebook (файл `train.ipynb`) состоит из следующих этапов:

1. **Импорты и подготовка путей**
   - Определяются пути к тренировочным и тестовым изображениям и маскам.
   - Создаётся структура директорий для данных в формате YOLO.

2. **Функции для обработки данных**
   - Конвертация масок в формат YOLO (`convert_mask_to_yolo`).
   - Копирование изображений и обработка масок для тренировочного и тестового набора.

3. **Обработка данных**
   - Обрабатываются изображения и маски, сохраняются в соответствующих папках:
     ```
     OUTPUT_DIR/images/train
     OUTPUT_DIR/images/val
     OUTPUT_DIR/labels/train
     OUTPUT_DIR/labels/val
     ```

4. **Создание файла `data.yaml`**
   - Файл `data.yaml` описывает структуру датасета, включая пути и классы.

5. **Обучение модели**
   - Указывается путь к модели (например, `yolo11n-seg.pt`).
   - Настраивается процесс обучения через `model.train`.

---

#### 2. **Как запустить `train.ipynb`**

1. **Откройте файл `train.ipynb`**
   - Откройте Jupyter Notebook:
     ```bash
     jupyter notebook train.ipynb
     ```

2. **Заполните пути**
   - В первой ячейке укажите корректные пути для ваших данных:
     ```python
     IMAGES_TRAIN_DIR = r"C:\path\to\train\images"
     IMAGES_TEST_DIR = r"C:\path\to\test\images"
     MASKS_TRAIN_DIR = r"C:\path\to\train\masks"
     MASKS_TEST_DIR = r"C:\path\to\test\masks"
     OUTPUT_DIR = r"C:\path\to\output"
     ```

3. **Выполните ячейки по порядку**
   - Запускайте ячейки по одной:
     - Первая ячейка: подготовка данных.
     - Следующие ячейки: обработка изображений и создание структуры директорий.
     - Последняя ячейка: запуск обучения.

4. **Проверьте результаты**
   - Убедитесь, что данные обработаны и сохранены в структуре:
     ```
     OUTPUT_DIR/
       ├── images/
       │   ├── train/
       │   └── val/
       ├── labels/
       │   ├── train/
       │   └── val/
       └── data.yaml
     ```
   - После выполнения всех ячеек начнётся обучение модели.

---

#### 3. **Выполнение обучения через Jupyter**
В последней ячейке запускается обучение модели:

```python
model = YOLO("yolo11n-seg.pt")
train_results = model.train(
    data=os.path.join(OUTPUT_DIR, 'data.yaml'),
    epochs=1000,
    imgsz=640,
    device=0,
    patience=500,
)
```

- Модель `yolo11n-seg.pt` используется как базовая.
- Данные берутся из `data.yaml`.

После завершения обучения результаты сохраняются в папке:
```
runs/train/
```

---

### Итог:
- Откройте файл `train.ipynb` в Jupyter Notebook.
- Заполняйте пути в первой ячейке.
- Выполняйте ячейки по порядку, завершая на этапе обучения.
- Проверьте сохранённые результаты.

Если требуется настройка или запуск через командную строку, дайте знать!